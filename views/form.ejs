<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <!--Main-->
    <div class="bg-dark min-vh-100 d-flex">
        <!-- Left Side: Form -->
        <div class="wrapper">
          <form action="/submit" method="POST" class="text-secondary">
            <img src="Blogify Logo - Original - 5000x5000.png" width="90" height="90"alt="icon">
            <h2 class="text-center">Create a Blog Post</h2>
            <input type="text" id="title" name="title" required placeholder="Title">
            <input type="text" id="author" name="author" required placeholder="Author">
            <textarea id="content" name="content" required placeholder="Write and let the world listen to your voice"></textarea>
            <button type="submit" class="button">Submit</button>
          </form>
        </div>
        <!--Form END-->

        <!-- Right Side: Posts -->
        <div class="cards-container">
          <div class="card">
            <div class="card-body">
              <span class="tag tag-purple">Popular</span>
              <h4>How to Keep Going When You Don’t Know What’s Next</h4>
              <p>The future can be scary, but there are ways to deal with that fear.</p>
              <div class="user-info">
                <button class="editBtn" type="button"><small>Edit</small></button>
                <button class="deleteBtn" type="button" data-post-id="<%=post.id  %>"><small>Delete</small></button>
              </div>
            </div>
          </div>
      
          <div class="card">
            <div class="card-body">
              <span class="tag tag-purple">Trending</span>
              <h4>New Blogging Strategies for 2024</h4>
              <p>Discover the latest techniques to grow your audience.</p>
              <div class="user-info">
                <button class="editBtn" type="button"><small>Edit</small></button>
                <button class="deleteBtn" type="button" data-post-id="<%=post.id  %>"><small>Delete</small></button>
              </div>
            </div>
          </div>
          <% if (typeof posts !== "undefined" && posts.length > 0) { %>
            <% posts.forEach(post => { %>
                <div class="card userCard" data-post-id="<%= post.id %>">
                    <div class="card-body">
                        <span class="tag tag-purple">New Post</span>
                        <h4><%= post.title %></h4>
                        <p><%= post.content %></p>
                        <p><small>By: <%= post.author %></small></p>
                        <div class="user-info">
                            <button class="editBtn" type="button"><small>Edit</small></button>
                            <button class="deleteBtn" type="button" data-post-id="<%= post.id %>"><small>Delete</small></button>
                        </div>
                    </div>
                </div>
            <% }); %>
        <% } else { %>
            <p style="color: red;">No posts yet. Start by writing one!</p>
        <% } %>
        
        
        <!--Card Container END-->
        </div>
    <!--Main END-->   
      </div>   
   
<script>
 

const deleteBtns = document.querySelectorAll(".deleteBtn");
  
deleteBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
    const postId=btn.getAttribute("data-post-id");
     fetch("/delete-post", {
       method: "DELETE",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({postId: postId}),
     })
     .then((response) => response.json())
     .then((data) => {
      console.log(data.message);
      btn.closest(".card").remove();
      })
      .catch((error) => {
        console.error("Error:", error);
      });
    });
  });
 

  
  



    
</script>      
</body>
</html>